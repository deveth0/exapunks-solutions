LINK 800

COPY M X
TEST X > 0
TJMP EAST
MARK WEST
; WALK WEST
TEST X = 0
TJMP VERTICAL
ADDI X 1 X
LINK 803
JUMP WEST

MARK VERTICAL
COPY M X
TEST X > 0
TJMP NORTH
MARK SOUTH
; WALK SOUTH
TEST X = 0
TJMP UPDATE
ADDI X 1 X
LINK 802
JUMP SOUTH

MARK NORTH
; WALK NORTH
TEST X = 0
TJMP UPDATE
SUBI X 1 X
LINK 800
JUMP NORTH

MARK EAST
; WALK EAST
TEST X = 0
TJMP VERTICAL
SUBI X 1 X
LINK 801
JUMP EAST

MARK UPDATE
GRAB 200
COPY M X
MARK FIND
TEST F = X
TJMP DOUPDATE
SEEK 5
JUMP FIND

MARK DOUPDATE
COPY F X
@REP 4
COPY X F
@END
